<!DOCTYPE html>
<html>
<head>
    <title>Test Natural Language Corrections</title>
</head>
<body>
    <h1>Natural Language Correction Test</h1>
    <textarea id="testInput" rows="5" cols="50"></textarea>
    <button onclick="testPatterns()">Test Patterns</button>
    <div id="output"></div>

    <script>
function parseCorrections(prompt) {
    const corrections = [];
    const lowerPrompt = prompt.toLowerCase();

    // Enhanced pattern matching for common correction phrases
    const patterns = [
        // Full name corrections
        {
            regex: /(?:change |update |set |make )?(?:candidate|name|person)(?: name)? (?:to |is |should be |= )([^,\.]+?)(?:[,\.]|$)/i,
            field: 'candidateName',
            extractor: (match) => match[1].trim()
        },
        // First name specific
        {
            regex: /(?:change |update |set |make )?(?:first name|firstname) (?:to |is |should be |= )([^,\.]+?)(?:[,\.]|$)/i,
            field: 'contactFirstName',
            extractor: (match) => match[1].trim()
        },
        // Last name specific
        {
            regex: /(?:change |update |set |make )?(?:last name|lastname) (?:to |is |should be |= )([^,\.]+?)(?:[,\.]|$)/i,
            field: 'contactLastName',
            extractor: (match) => match[1].trim()
        },
        // Phone corrections
        {
            regex: /(?:change |update |set |make )?(?:phone|number|cell)(?: number)? (?:to |is |should be |: |= )([\\d\\s\\-\\(\\)\\+]+)/i,
            field: 'candidatePhone',
            extractor: (match) => match[1].trim()
        },
        // Email corrections
        {
            regex: /(?:change |update |set |make )?email(?: address)? (?:to |is |should be |: |= )([^\\s,]+@[^\\s,]+)/i,
            field: 'candidateEmail',
            extractor: (match) => match[1].trim()
        },
        // Location corrections
        {
            regex: /(?:change |update |set |make )?(?:location|city|place) (?:to |is |should be |= )([^,\.]+?)(?:[,\.]|$)/i,
            field: 'location',
            extractor: (match) => match[1].trim()
        },
        // Job title corrections
        {
            regex: /(?:change |update |set |make )?(?:job|title|position|role)(?: title)? (?:to |is |should be |= )([^,\.]+?)(?:[,\.]|$)/i,
            field: 'jobTitle',
            extractor: (match) => match[1].trim()
        },
        // Company corrections
        {
            regex: /(?:change |update |set |make )?(?:company|firm|organization)(?: name)? (?:to |is |should be |name |= )([^,\.]+?)(?:[,\.]|$)/i,
            field: 'firmName',
            extractor: (match) => match[1].trim()
        }
    ];

    // Check for corrections/replacements
    patterns.forEach(pattern => {
        const match = prompt.match(pattern.regex);
        if (match) {
            corrections.push({
                field: pattern.field,
                value: pattern.extractor(match),
                action: 'replace'
            });
        }
    });

    return corrections;
}

function testPatterns() {
    const input = document.getElementById('testInput').value;
    const corrections = parseCorrections(input);
    const output = document.getElementById('output');

    output.innerHTML = '<h2>Parsed Corrections:</h2>';
    if (corrections.length > 0) {
        corrections.forEach(c => {
            output.innerHTML += `<p>Field: ${c.field}, Value: "${c.value}", Action: ${c.action}</p>`;
        });
    } else {
        output.innerHTML += '<p>No corrections found</p>';
    }

    // Test specific examples
    const testCases = [
        "change last name to Janse",
        "change email to roy.janse@mariner.com",
        "update first name to Roy",
        "email should be test@example.com",
        "phone is 555-1234",
        "company is Mariner Wealth"
    ];

    output.innerHTML += '<h2>Test Cases:</h2>';
    testCases.forEach(test => {
        const result = parseCorrections(test);
        output.innerHTML += `<p>"${test}" -> ${result.length > 0 ?
            `${result[0].field}: "${result[0].value}"` : 'NO MATCH'}</p>`;
    });
}
    </script>
</body>
</html>